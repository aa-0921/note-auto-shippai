// scripts/commentOnAccountsArticles.js
// è–„ã„ãƒ©ãƒƒãƒ‘ãƒ¼ï¼šæ—¢å­˜ã®CLIå¼•æ•°ãƒ»å‹•ä½œã¯ç¶­æŒã—ã¤ã¤ã€å®Ÿè£…ã¯å…±æœ‰ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«å§”è­²

import { runWithCore } from '@aa-0921/note-auto-core';

(async () => {
  await runWithCore(async ({ core, wantsBackground }) => {
    // ======================================
    // ã“ã“ã‚’ã‚«ã‚¹ã‚¿ãƒžã‚¤ã‚ºã—ã¦ãã ã•ã„
    // ======================================
    
    // ç¾åœ¨ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆåï¼ˆã“ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã—ã¦ã„ã‚‹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆï¼‰
    const currentAccount = 'konkatsu_misa';  // ä¾‹: 'konkatsu'
    
    // ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã”ã¨ã®æœ€å¤§ã‚³ãƒ¡ãƒ³ãƒˆæ•°
    const maxCommentsPerAccount = 5;  // ä¾‹: 1ï¼ˆå„ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®è¨˜äº‹1ä»¶ã«ã‚³ãƒ¡ãƒ³ãƒˆï¼‰
    
    // å¯¾è±¡ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒªã‚¹ãƒˆï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ã€æœªæŒ‡å®šã®å ´åˆã¯DEFAULT_LIKE_TARGET_ACCOUNTSã‚’ä½¿ç”¨ï¼‰
    // const targetAccounts = ['counselor_risa', 'investment_happy'];  // ä¾‹: ç‰¹å®šã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ã¿
    const targetAccounts = undefined;  // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã¯ undefined
    
    // ã‚³ãƒ¡ãƒ³ãƒˆã®æœ€åˆã«å…¥ã‚Œã‚‹ãƒ•ãƒ¬ãƒ¼ã‚ºé…åˆ—ï¼ˆãƒ©ãƒ³ãƒ€ãƒ ã§1ã¤é¸æŠžã•ã‚Œã¾ã™ï¼‰
    const commentOpeningPhrases = [
      'èª­ã¾ã›ã¦ã„ãŸã ãã¾ã—ãŸðŸ’•',
      'ç´ æ•µãªè¨˜äº‹ã‚’ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ðŸŒ¸',
      'é¢ç™½ã‹ã£ãŸã§ã™âœ¨',
      'å‚è€ƒã«ãªã‚Šã¾ã—ãŸðŸ’•',
      'å¤§å¤‰å‹‰å¼·ã«ãªã‚Šã¾ã—ãŸðŸŒ¸',
      'ãŠã‚‚ã—ã‚ã„ã§ã™ã­ï¼âœ¨',
      'ãŠæ°—æŒã¡ã€ã‚ˆãã‚ã‹ã‚Šã¾ã™ðŸ’•',
      'èˆˆå‘³æ·±ãæ‹èª­ã—ã¾ã—ãŸðŸŒ¸',
      'ãŠã‚‚ã—ã‚ã„å†…å®¹ã§ã—ãŸâœ¨',
    ];

    // ãƒ©ãƒ³ãƒ€ãƒ ã§1ã¤ã®ãƒ•ãƒ¬ãƒ¼ã‚ºã‚’é¸æŠž
    const selectedOpeningPhrase = commentOpeningPhrases[Math.floor(Math.random() * commentOpeningPhrases.length)];

    // ã‚³ãƒ¡ãƒ³ãƒˆã®æœ€å¾Œã«å…¥ã‚Œã‚‹å‰ç½®ããƒ•ãƒ¬ãƒ¼ã‚ºé…åˆ—ï¼ˆãƒ©ãƒ³ãƒ€ãƒ ã§1ã¤é¸æŠžã•ã‚Œã¾ã™ï¼‰
    const commentSuffixOpeningPhrases = [
      'ðŸ’•ã‚‚ã—ã‚ˆã‚ã—ã‘ã‚Œã°',
      'ðŸŒ¸ã‚ˆã‚ã—ã‘ã‚Œã°',
      'âœ¨ã‚‚ã—å·®ã—æ”¯ãˆãªã‘ã‚Œã°',
      'ðŸ’•å·®ã—æ”¯ãˆãªã‘ã‚Œã°',
      'ðŸŒ¸ã‚‚ã—å¯èƒ½ã§ã—ãŸã‚‰',
      'âœ¨ã‚‚ã—ãŠæ™‚é–“ãŒã‚ã‚Œã°',
      'ðŸ’•ã‚‚ã—è‰¯ã‹ã£ãŸã‚‰',
      'ðŸŒ¸è‰¯ã‹ã£ãŸã‚‰',
      'âœ¨ã‚‚ã—ãŠé¡˜ã„ã§ãã‚Œã°',
      'ðŸ’•ã‚‚ã—ã”éƒ½åˆãŒã‚ˆã‚ã—ã‘ã‚Œã°',
      'ðŸŒ¸ã‚‚ã—ãŠæ°—ãŒå‘ã„ãŸã‚‰',
      'âœ¨ã‚‚ã—ãŠæš‡ãŒã‚ã‚Œã°',
      'ðŸ’•ãŠæ™‚é–“ãŒè¨±ã›ã°',
      'ðŸŒ¸ã‚‚ã—ãŠé¡˜ã„ã§ãã¾ã—ãŸã‚‰',
      'âœ¨ãŠé¡˜ã„ã§ãã¾ã—ãŸã‚‰',
    ];

    // ãƒ©ãƒ³ãƒ€ãƒ ã§1ã¤ã®å‰ç½®ããƒ•ãƒ¬ãƒ¼ã‚ºã‚’é¸æŠž
    const selectedSuffixOpeningPhrase = commentSuffixOpeningPhrases[Math.floor(Math.random() * commentSuffixOpeningPhrases.length)];

    // ã‚³ãƒ¡ãƒ³ãƒˆã®å…ˆé ­/æœ«å°¾ã«ä»˜ã‘ã‚‹å›ºå®šæ–‡ï¼ˆå¿…è¦ã«å¿œã˜ã¦ã“ã“ã‚’ç·¨é›†ã—ã¦ãã ã•ã„ï¼‰
    const commentPrefix = `${selectedOpeningPhrase} ã‚³ãƒ¡ãƒ³ãƒˆã•ã›ã¦ã„ãŸã ãã¾ã™ðŸ’•ãƒ•ã‚©ãƒ­ãƒ¼ãƒ»ã‚¹ã‚­ã‚‚ã•ã›ã¦ã„ãŸã ãã¾ã—ãŸðŸŒ¸`;
    const commentSuffix =
      `${selectedSuffixOpeningPhrase}ã€ç§ã®è¨˜äº‹ã«ã‚‚ã‚³ãƒ¡ãƒ³ãƒˆãƒ»ãƒ•ã‚©ãƒ­ãƒ¼ãƒ»ã‚¹ã‚­ã‚’ã„ãŸã ã‘ã¾ã™ã¨å¤§å¤‰åŠ±ã¿ã«ãªã‚Šã¾ã™ðŸ™‡â€â™€ï¸`;

    // è¿½åŠ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
    // ä¾‹ï¼šã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®å±žæ€§ï¼ˆå¹´é½¢ã€æ€§åˆ¥ãªã©ï¼‰ã‚’æŒ‡å®š
    const additionalPrompt = `40ä»£å¥³æ€§ã®å£èª¿ã§æ›¸ã„ã¦ãã ã•ã„ã€‚
- è½ã¡ç€ã„ãŸã€æˆç†Ÿã—ãŸè¡¨ç¾ã‚’å¿ƒãŒã‘ã¦ãã ã•ã„
- äººç”ŸçµŒé¨“ã‚’è¸ã¾ãˆãŸå…±æ„Ÿã‚’ç¤ºã™è¡¨ç¾ï¼ˆã€Œç§ã‚‚åŒã˜çµŒé¨“ã‚’ã—ã¾ã—ãŸã€ã€ŒãŠæ°—æŒã¡ã€ã‚ˆãã‚ã‹ã‚Šã¾ã™ã€ãªã©ï¼‰ã‚’è‡ªç„¶ã«ä½¿ã£ã¦ãã ã•ã„
- è¦ªã—ã¿ã‚„ã™ã•ã‚’ä¿ã¡ã¤ã¤ã€é©åº¦ãªä¸å¯§ã•ã‚‚å¤§åˆ‡ã«ã—ã¦ãã ã•ã„
- åŒä¸–ä»£ã¸ã®ç†è§£ã¨å…±æ„Ÿã‚’å¤§åˆ‡ã«ã—ã€çµŒé¨“ã«åŸºã¥ã„ãŸæ¸©ã‹ã„ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã‚‚å«ã‚ã¦ãã ã•ã„
- éŽåº¦ã«è‹¥ã€…ã—ã„è¡¨ç¾ã¯é¿ã‘ã€ã§ã‚‚å …è‹¦ã—ã™ãŽãªã„è‡ªç„¶ãªå£èª¿ã‚’å¿ƒãŒã‘ã¦ãã ã•ã„`;

    // ãƒ™ãƒ¼ã‚¹ã‚·ã‚¹ãƒ†ãƒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«è¿½åŠ ã™ã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
    // ä¾‹ï¼šã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®å±žæ€§ï¼ˆå¹´é½¢ã€æ€§åˆ¥ãªã©ï¼‰ã‚’æŒ‡å®š
    const additionalSystemMessage = `ã‚ãªãŸã¯40ä»£ã®å¥³æ€§ãƒ¦ãƒ¼ã‚¶ãƒ¼ã§ã™ã€‚
äººç”ŸçµŒé¨“ã‚’ç©ã‚“ã è½ã¡ç€ã„ãŸå£èª¿ã§ã€è¦ªã—ã¿ã‚„ã™ãæ¸©ã‹ã„ã‚³ãƒ¡ãƒ³ãƒˆã‚’æ›¸ã„ã¦ãã ã•ã„ã€‚
åŒä¸–ä»£ã®æ‚©ã¿ã«å…±æ„Ÿã—ã€çµŒé¨“ã«åŸºã¥ã„ãŸè‡ªç„¶ãªã‚¢ãƒ‰ãƒã‚¤ã‚¹ã‚‚å«ã‚ã¦ãã ã•ã„ã€‚
éŽåº¦ã«è‹¥ã€…ã—ã„è¡¨ç¾ã¯é¿ã‘ã€ã§ã‚‚å …è‹¦ã—ã™ãŽãªã„ã€ãƒãƒ©ãƒ³ã‚¹ã®å–ã‚ŒãŸè¡¨ç¾ã‚’å¿ƒãŒã‘ã¦ãã ã•ã„ã€‚`;
    
    // ======================================
    
    console.log('=== ã‚¢ã‚«ã‚¦ãƒ³ãƒˆé–“ã‚³ãƒ¡ãƒ³ãƒˆæŠ•ç¨¿å‡¦ç†ã‚’é–‹å§‹ã—ã¾ã™ ===');
    console.log(`ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã”ã¨ã®æœ€å¤§ã‚³ãƒ¡ãƒ³ãƒˆæ•°: ${maxCommentsPerAccount}ä»¶`);
    console.log('');
    
    // ã‚ªãƒ—ã‚·ãƒ§ãƒ³è¨­å®š
    const options = {
      currentAccount: currentAccount,
      maxCommentsPerAccount: maxCommentsPerAccount,
      targetAccounts: targetAccounts,
      additionalPrompt: additionalPrompt,
      additionalSystemMessage: additionalSystemMessage,
      // AIç”Ÿæˆæœ¬æ–‡ã®å‰å¾Œã«å›ºå®šæ–‡ã‚’ä»˜ä¸Žï¼ˆcoreå´ã§ä»˜ä¸Žï¼‰
      commentPrefix: commentPrefix,
      commentSuffix: commentSuffix
    };
    
    // ã‚¢ã‚«ã‚¦ãƒ³ãƒˆé–“ã‚³ãƒ¡ãƒ³ãƒˆæŠ•ç¨¿ã‚’å®Ÿè¡Œ
    const result = await core.runCommentOnAccountsArticles(options);
    
    console.log('');
    console.log('âœ… ã‚¢ã‚«ã‚¦ãƒ³ãƒˆé–“ã‚³ãƒ¡ãƒ³ãƒˆæŠ•ç¨¿ãŒå®Œäº†ã—ã¾ã—ãŸ');
    console.log(`ç·ã‚³ãƒ¡ãƒ³ãƒˆæˆåŠŸä»¶æ•°: ${result.commentCount}ä»¶`);
    console.log(`å‡¦ç†ã—ãŸã‚¢ã‚«ã‚¦ãƒ³ãƒˆæ•°: ${result.accountsProcessed}ä»¶`);
    
    if (result.accounts && result.accounts.length > 0) {
      console.log('');
      console.log('ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã”ã¨ã®å‡¦ç†çµæžœ:');
      result.accounts.forEach((accountResult, index) => {
        console.log(`  ${index + 1}. @${accountResult.account}: ${accountResult.commentCount}ä»¶ / ${accountResult.targetCount}ä»¶${accountResult.error ? ` (ã‚¨ãƒ©ãƒ¼: ${accountResult.error})` : ''}`);
      });
    }
  });
})();
